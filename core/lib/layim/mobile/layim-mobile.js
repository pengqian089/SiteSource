/** The Web UI Theme-v4.0.1 */;layui.define(["laytpl","upload","layer-mobile","zepto"],function(e){function a(){this.v=t,s(r("body"),"*[layim-event]",function(e){var a=r(this),i=a.attr("layim-event");M[i]&&M[i].call(this,a,e)})}function s(e,a,i){function t(e){var a=r(this);a.data("lock")||(l||i.call(this,e),l=!1,a.data("lock","true"),setTimeout(function(){a.removeAttr("data-lock")},a.data("locktime")||0))}var l,n="function"==typeof a;n&&(i=a),e="string"==typeof e?r(e):e,v?n?e.on("touchmove",function(){l=!0}).on("touchend",t):e.on("touchmove",a,function(){l=!0}).on("touchend",a,t):n?e.on("click",t):e.on("click",a,t)}function o(e,a,i){return['<div class="layim-panel'+(a?" layui-m-anim-left":"")+'">','<div class="layim-title" style="background-color: {{=d.base.chatTitleColor}};">',"<p>",i?'<i class="layui-icon layim-chat-back" layim-event="back">&#xe603;</i>':"",'{{= d.title || d.base.title }}<span class="layim-chat-status"></span>',"{{# if(d.data){ }}",'{{# if(d.data.type === "group"){ }}','<i class="layui-icon layim-chat-detail" layim-event="detail">&#xe613;</i>',"{{# } }}","{{# } }}","</p>","</div>",'<div class="layui-unselect layim-content">',e,"</div>","</div>"].join("")}function i(e){return e<10?"0"+(0|e):e}function u(e){var a,i,t,l=layui.data("layim-mobile")[C.user.id]||{},n={},s=l.history||{};s[e.type+e.id],c&&(a=c.find(".layim-list-history"),e.historyTime=(new Date).getTime(),e.sign=e.content,s[e.type+e.id]=e,l.history=s,layui.data("layim-mobile",{key:C.user.id,value:l}),i=a.find(".layim-"+e.type+e.id),t=(C.message[e.type+e.id]||[]).length,s=function(){(i=a.find(".layim-"+e.type+e.id)).find("p").html(e.content),0<t&&i.find(".layim-msg-status").html(t).addClass(p)},(0<i.length?(s(),a.prepend(i.clone()),i):(n[e.type+e.id]=e,l=y(g({type:"history",item:"d.data"})).render({data:n}),a.prepend(l),s(),a.find(".layim-null"))).remove(),H("Msg"))}function d(e,a,i){var t,l=e.value;i||e.focus(),document.selection?(t=document.selection.createRange(),document.selection.empty(),t.text=a):(t=[l.substring(0,e.selectionStart),a,l.substr(e.selectionEnd)],i||e.focus(),e.value=t.join(""))}var c,n,t="3.9.9",r=layui.zepto,y=layui.laytpl,m=layui["layer-mobile"],l=layui.device(),p="layui-show",f="layim-this",h={},v=/Android|iPhone|SymbianOS|Windows Phone|iPad|iPod/.test(navigator.userAgent),g=(m.popBottom=function(e){m.close(m.popBottom.index),m.popBottom.index=m.open(r.extend({type:1,content:e.content||"",shade:!1,className:"layim-layer"},e))},a.prototype.config=function(e){e=r.extend({title:"\u6211\u7684 IM",isgroup:0,isNewFriend:!0,voice:"default.mp3",chatTitleColor:"#36373C",defaultAvatar:(e=e||{}).defaultAvatar||layui.cache.layimResPath+"images/default.png"},e),k(e)},a.prototype.on=function(e,a){return"function"==typeof a&&(h[e]?h[e].push(a):h[e]=[a]),this},a.prototype.chat=function(e){if(window.JSON&&window.JSON.parse)return L(e,-1),this},a.prototype.panel=function(e){return S(e)},a.prototype.cache=function(){return C},a.prototype.getMessage=function(e){return q(e),this},a.prototype.addList=function(e){return $(e),this},a.prototype.removeList=function(e){return Y(e),this},a.prototype.setFriendStatus=function(e,a){r(".layim-friend"+e)["online"===a?"removeClass":"addClass"]("layim-list-gray")},a.prototype.setChatStatus=function(e){return T().elem.find(".layim-chat-status").html(e),this},a.prototype.showNew=function(e,a){H(e,a)},a.prototype.content=function(e){return layui.data.content(e)},function(e){return"history"===(e=e||{}).type&&(e.item=e.item||"d.sortHistory"),["{{# var length = 0; layui.each("+e.item+", function(i, data){ length++; }}",'<li layim-event="chat" data-type="'+e.type+'" data-index="'+(e.index?"{{="+e.index+"}}":("history"===e.type?"{{=data.type}}":e.type)+"{{=data.id}}")+'" class="layim-'+("history"===e.type?"{{=data.type}}":e.type)+'{{=data.id}} {{= data.status === "offline" ? "layim-list-gray" : "" }}"><div><img src="{{=data.avatar || layui[\'layim-mobile\'].cache().base.defaultAvatar }}"></div><span>{{= data.username||data.groupname||data.name||"\u4f5a\u540d" }}</span><p>{{= data.remark||data.sign||"" }}</p><span class="layim-msg-status">new</span></li>',"{{# }); if(length === 0){ }}",'<li class="layim-null">'+({friend:"\u8be5\u5206\u7ec4\u4e0b\u6682\u65e0\u597d\u53cb",group:"\u6682\u65e0\u7fa4\u7ec4",history:"\u6682\u65e0\u4efb\u4f55\u6d88\u606f"}[e.type]||"\u6682\u65e0\u6570\u636e")+"</li>","{{# } }}"].join("")}),b=['<div class="layui-layim">','<div class="layim-tab-content layui-show">','<ul class="layim-list-friend">','<ul class="layui-layim-list layui-show layim-list-history">',g({type:"history"}),"</ul>","</ul>","</div>",'<div class="layim-tab-content">','<ul class="layim-list-top">',"{{# if(d.base.isNewFriend){ }}",'<li layim-event="newFriend"><i class="layui-icon">&#xe654;</i>\u65b0\u7684\u670b\u53cb<i class="layim-new" id="LAY_layimNewFriend"></i></li>',"{{# } if(d.base.isgroup){ }}",'<li layim-event="group"><i class="layui-icon">&#xe613;</i>\u7fa4\u804a<i class="layim-new" id="LAY_layimNewGroup"></i></li>',"{{# } }}","</ul>",'<ul class="layim-list-friend">','{{# layui.each(d.friend, function(index, item){ var spread = d.local["spread"+index]; }}',"<li>",'<h5 layim-event="spread" lay-type="{{= spread }}"><i class="layui-icon">{{# if(spread === "true"){ }}&#xe61a;{{# } else {  }}&#xe602;{{# } }}</i><span>{{= item.groupname||"\u672a\u547d\u540d\u5206\u7ec4"+index }}</span><em>(<cite class="layim-count"> {{= (item.list||[]).length }}</cite>)</em></h5>','<ul class="layui-layim-list {{# if(spread === "true"){ }}'," layui-show",'{{# } }}">',g({type:"friend",item:"item.list",index:"index"}),"</ul>","</li>","{{# }); if(d.friend.length === 0){ }}",'<li><ul class="layui-layim-list layui-show"><li class="layim-null">\u6682\u65e0\u8054\u7cfb\u4eba</li></ul>',"{{# } }}","</ul>","</div>",'<div class="layim-tab-content">','<ul class="layim-list-top">',"{{# layui.each(d.base.moreList, function(index, item){ }}",'<li layim-event="moreList" lay-filter="{{= item.alias }}">','<i class="layui-icon {{=item.iconClass||""}}">{{=item.iconUnicode||""}}</i>{{=item.title}}<i class="layim-new" id="LAY_layimNew{{= item.alias }}"></i>',"</li>","{{# }); if(!d.base.copyright){ }}",'<li layim-event="about"><i class="layui-icon">&#xe60b;</i>\u5173\u4e8e<i class="layim-new" id="LAY_layimNewAbout"></i></li>',"{{# } }}","</ul>","</div>","</div>",'<ul class="layui-unselect layui-layim-tab">','<li title="\u6d88\u606f" layim-event="tab" lay-type="message" class="layim-this"><i class="layui-icon">&#xe611;</i><span>\u6d88\u606f</span><i class="layim-new" id="LAY_layimNewMsg"></i></li>','<li title="\u8054\u7cfb\u4eba" layim-event="tab" lay-type="friend"><i class="layui-icon">&#xe612;</i><span>\u8054\u7cfb\u4eba</span><i class="layim-new" id="LAY_layimNewList"></i></li>','<li title="\u66f4\u591a" layim-event="tab" lay-type="more"><i class="layui-icon">&#xe670;</i><span>\u66f4\u591a</span><i class="layim-new" id="LAY_layimNewMore"></i></li>',"</ul>"].join(""),x=['<div class="layim-chat layim-chat-{{=d.data.type}}">','<div class="layim-chat-main">',"<ul></ul>","</div>",'<div class="layim-chat-footer">','<div class="layim-chat-send"><input type="text" autocomplete="off"><button class="layim-send layui-disabled" layim-event="send">\u53d1\u9001</button></div>','<div class="layim-chat-tool" data-json="{{=encodeURIComponent(JSON.stringify(d.data))}}">','<span class="layui-icon layim-tool-face" title="\u9009\u62e9\u8868\u60c5" layim-event="face">&#xe60c;</span>',"{{# if(d.base && d.base.uploadImage){ }}",'<span class="layui-icon layim-tool-image" title="\u4e0a\u4f20\u56fe\u7247" layim-event="image">&#xe60d;<input type="file" name="file" accept="image/*"></span>',"{{# }; }}","{{# if(d.base && d.base.uploadFile){ }}",'<span class="layui-icon layim-tool-image" title="\u53d1\u9001\u6587\u4ef6" layim-event="image" data-type="file">&#xe61d;<input type="file" name="file"></span>',"{{# }; }}","{{# layui.each(d.base.tool, function(index, item){ }}",'<span class="layui-icon  {{=item.iconClass||""}} layim-tool-{{=item.alias}}" title="{{=item.title}}" layim-event="extend" lay-filter="{{= item.alias }}">{{=item.iconUnicode||""}}</span>',"{{# }); }}","</div>","</div>","</div>"].join(""),w=(layui.data.date=function(e){e=new Date(e||new Date);return i(e.getMonth()+1)+"-"+i(e.getDate())+" "+i(e.getHours())+":"+i(e.getMinutes())},layui.data.content=function(e){function a(e){return new RegExp("\\n*\\["+(e||"")+"(pre|div|p|table|thead|th|tbody|tr|td|ul|li|ol|li|dl|dt|dd|h2|h3|h4|h5)([\\s\\S]*?)\\]\\n*","g")}return e=(e||"").replace(/&(?!#?[a-zA-Z0-9]+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#39;").replace(/"/g,"&quot;").replace(/@(\S+)(\s+?|$)/g,'@<a href="javascript:;">$1</a>$2').replace(/face\[([^\s\[\]]+?)\]/g,function(e){e=e.replace(/^face/g,"");return'<img alt="'+e+'" title="'+e+'" src="'+D[e]+'">'}).replace(/img\[([^\s]+?)\]/g,function(e){return'<img class="layui-layim-photos" src="'+e.replace(/(^img\[)|(\]$)/g,"")+'">'}).replace(/file\([\s\S]+?\)\[[\s\S]*?\]/g,function(e){var a=(e.match(/file\(([\s\S]+?)\)\[/)||[])[1],i=(e.match(/\)\[([\s\S]*?)\]/)||[])[1];return a?'<a class="layui-layim-file" href="'+a+'" download target="_blank"><i class="layui-icon">&#xe61e;</i><cite>'+(i||a)+"</cite></a>":e}).replace(/audio\[([^\s]+?)\]/g,function(e){return'<div class="layui-unselect layui-layim-audio" layim-event="playAudio" data-src="'+e.replace(/(^audio\[)|(\]$)/g,"")+'"><i class="layui-icon">&#xe652;</i><p>\u97f3\u9891\u6d88\u606f</p></div>'}).replace(/video\[([^\s]+?)\]/g,function(e){return'<div class="layui-unselect layui-layim-video" layim-event="playVideo" data-src="'+e.replace(/(^video\[)|(\]$)/g,"")+'"><i class="layui-icon">&#xe652;</i></div>'}).replace(/a\([\s\S]+?\)\[[\s\S]*?\]/g,function(e){var a=(e.match(/a\(([\s\S]+?)\)\[/)||[])[1],i=(e.match(/\)\[([\s\S]*?)\]/)||[])[1];return a?'<a href="'+a+'" target="_blank">'+(i||a)+"</a>":e}).replace(a(),"<$1 $2>").replace(a("/"),"</$1>").replace(/\n/g,"<br>")},['<li class="layim-chat-li{{= d.user ? " layim-chat-role-user" : "" }}">','<div class="layim-chat-userinfo">','<img src="{{= d.avatar || layui[\'layim-mobile\'].cache().base.defaultAvatar }}" alt="{{= d.uid || d.id }}"><cite>','{{= d.username||"\u4f5a\u540d" }}',"</cite>","</div>",'{{# var content = d.content || "&nbsp"; }}','<div class="layim-chat-text layui-text">','{{# if(d.type === "ai"){ }}',"{{- content }}","{{# } else { }}","{{- layui.data.content(content) }}","{{# } }}","</div>","</li>"].join("")),C={message:{},chat:[]},k=function(e){var i,a=e.init||{},t=a.user||{},l=layui.data("layim-mobile")[t.id]||{},n={base:e,local:l,user:t,history:l.history||[]};if(C=r.extend(C,n),e.brief)return layui.each(h.ready,function(e,a){a&&a(n)});l=(t=a).user||{},a=layui.data("layim-mobile")[l.id]||{},(i={base:e,local:a,user:l,friend:t.friend||[],group:t.group||[],history:a.history||[]}).sortHistory=F(i.history,"historyTime"),C=r.extend(C,i),A(y(o(b)).render(i)),layui.each(h.ready,function(e,a){a&&a(i)})},A=function(e){return m.open({type:1,shade:!1,shadeClose:!1,anim:-1,content:e,success:function(e){c=r(e),N(c.find(".layui-layim")),C.base.tabIndex&&M.tab(r(".layui-layim-tab>li").eq(C.base.tabIndex))}})},S=function(i,e){i=i||{};var a=r.extend({},C,{title:i.title||"",data:i.data}),t='<div class="layui-layim" style="bottom: 0;">'+i.tpl+"</div>";return m.open({type:1,shade:!1,shadeClose:!1,anim:-1,content:y(o(t,-1!==e,!0)).render(a),success:function(e){var a=r(e);a.prev().find(".layim-panel").addClass("layui-m-anim-lout"),i.success&&i.success(e),i.isChat||N(a.find(".layim-content"))},end:i.end})},L=function(t,e,a){return(t=t||{}).id?(m.close(L.index),L.index=S({tpl:x,data:t,title:t.name,isChat:!0,success:function(e){n=r(e),P(),O(),delete C.message[t.type+t.id],H("Msg");var i=T(),a=i.elem.find(".layim-chat-main");layui.each(h.chatChange,function(e,a){a&&a(i)}),N(a),i.textarea.on("focus",function(){setTimeout(function(){a.scrollTop(a[0].scrollHeight+1e3)},500)})},end:function(){n=null,_.time=0}},e)):m.msg("\u975e\u6cd5\u7528\u6237")},N=function(i){l.ios&&i.on("touchmove",function(e){var a=i.scrollTop();a<=0&&(i.scrollTop(1),e.preventDefault(e)),this.scrollHeight-a-i.height()<=0&&(i.scrollTop(i.scrollTop()-1),e.preventDefault(e))})},T=function(){var e,a;return n?(e=n.find(".layim-chat"),a=JSON.parse(decodeURIComponent(e.find(".layim-chat-tool").data("json"))),{elem:e,data:a,textarea:e.find("input")}):{}},F=function(e,i,a){var t=[];return layui.each(e,function(e,a){t.push(a)}),t.sort(function(e,a){e=e[i],a=a[i];return a<e?-1:e<a?1:0}),a&&t.reverse(),t},H=function(e,a){a||layui.each(C.message,function(){return!(a=!0)}),r("#LAY_layimNew"+e)[a?"addClass":"removeClass"](p)},_=function(){var e={username:C.user?C.user.username:"\u8bbf\u5ba2",avatar:C.user?C.user.avatar:C.base.defaultAvatar,id:C.user?C.user.id:null,user:!0},a=T(),i=a.elem.find(".layim-chat-main ul"),t=a.data,l=C.base.maxLength||3e3,n=(new Date).getTime(),a=a.textarea;if(e.content=a.val(),""!==e.content){if(e.content.length>l)return m.msg("\u5185\u5bb9\u6700\u957f\u4e0d\u80fd\u8d85\u8fc7"+l+"\u4e2a\u5b57\u7b26");6e4<n-(_.time||0)&&(i.append('<li class="layim-chat-system"><span>'+layui.data.date()+"</span></li>"),_.time=n),i.append(y(w).render(e));var s={user:e,receiver:t},l={username:s.user.username,avatar:s.user.avatar||C.base.defaultAvatar,id:t.id,type:t.type,content:s.user.content,timestamp:n,user:!0};I(l),layui.each(h.sendMessage,function(e,a){a&&a(s)}),t.content=e.content,u(t),j(),a.val(""),a.next().addClass("layui-disabled")}},q=function(i){i=i||{};var t,l={},e=T().data||{},e=e.id==i.id&&e.type==i.type,l=(i.timestamp=i.timestamp||(new Date).getTime(),i.system||I(i),JSON.parse(JSON.stringify(i)),C.base.voice&&(q.init?((a=document.createElement("audio")).src=layui.cache.layimResPath+"voice/"+C.base.voice,a.play()):q.init=!0),(n||!i.content)&&e||(C.message[i.type+i.id]?C.message[i.type+i.id].push(i):C.message[i.type+i.id]=[i]),{}),a=("friend"===i.type?(layui.each(C.friend,function(e,a){if(layui.each(a.list,function(e,a){if(a.id==i.id)return i.type="friend",i.name=a.username,t=!0}),t)return!0}),t||(i.temporary=!0)):"group"===i.type?layui.each(C.group,function(e,a){if(a.id==i.id)return i.type="group",i.name=i.groupname=a.groupname,l.avatar=a.avatar||C.base.defaultAvatar,!0}):i.name=i.name||i.username||i.groupname,r.extend({},i,{avatar:l.avatar||i.avatar||C.base.defaultAvatar}));"group"===i.type&&delete a.username,u(a),n&&e&&(e=n.find(".layim-chat").find(".layim-chat-main ul"),i.system?e.append('<li class="layim-chat-system"><span>'+i.content+"</span></li>"):""!==i.content.replace(/\s/g,"")&&(6e4<i.timestamp-(_.time||0)&&(e.append('<li class="layim-chat-system"><span>'+layui.data.date(i.timestamp)+"</span></li>"),_.time=i.timestamp),e.append(y(w).render(i))),j())},I=function(e){var a=layui.data("layim-mobile")[C.user.id]||{},i=a.chatlog||{};i[e.type+e.id]?(i[e.type+e.id].push(e),20<i[e.type+e.id].length&&i[e.type+e.id].shift()):i[e.type+e.id]=[e],a.chatlog=i,layui.data("layim-mobile",{key:C.user.id,value:a})},O=function(){var e=layui.data("layim-mobile")[C.user.id]||{},a=T(),e=e.chatlog||{},i=a.elem.find(".layim-chat-main ul");layui.each(e[a.data.type+a.data.id],function(e,a){(new Date).getTime()>a.timestamp&&6e4<a.timestamp-(_.time||0)&&(i.append('<li class="layim-chat-system"><span>'+layui.data.date(a.timestamp)+"</span></li>"),_.time=a.timestamp),i.append(y(w).render(a))}),j()},$=function(i){var t,e,a,l={},n=c.find(".layim-list-"+i.type);if(C[i.type])if("friend"===i.type)layui.each(C.friend,function(e,a){if(i.groupid==a.id)return layui.each(C.friend[e].list,function(e,a){if(a.id==i.id)return t=!0}),t?m.msg("\u597d\u53cb ["+(i.username||"")+"] \u5df2\u7ecf\u5b58\u5728\u5217\u8868\u4e2d",{anim:6}):(C.friend[e].list=C.friend[e].list||[],(l[C.friend[e].list.length]=i).groupIndex=e,C.friend[e].list.push(i),!0)});else if("group"===i.type){if(layui.each(C.group,function(e,a){if(a.id==i.id)return t=!0}),t)return m.msg("\u60a8\u5df2\u662f ["+(i.groupname||"")+"] \u7684\u7fa4\u6210\u5458",{anim:6});l[C.group.length]=i,C.group.push(i)}t||(e=y(g({type:i.type,item:"d.data",index:"friend"===i.type?"data.groupIndex":null})).render({data:l}),"friend"===i.type?((a=n.children("li").eq(i.groupIndex)).find(".layui-layim-list").append(e),a.find(".layim-count").html(C.friend[i.groupIndex].list.length),a.find(".layim-null")[0]&&a.find(".layim-null").remove()):"group"===i.type&&(n.append(e),n.find(".layim-null")[0])&&n.find(".layim-null").remove())},Y=function(t){var l=c.find(".layim-list-"+t.type);C[t.type]&&("friend"===t.type?layui.each(C.friend,function(i,e){layui.each(e.list,function(e,a){if(t.id==a.id)return(a=l.children("li").eq(i)).find(".layui-layim-list").children("li"),a.find(".layui-layim-list").children("li").eq(e).remove(),C.friend[i].list.splice(e,1),a.find(".layim-count").html(C.friend[i].list.length),0===C.friend[i].list.length&&a.find(".layui-layim-list").html('<li class="layim-null">\u8be5\u5206\u7ec4\u4e0b\u5df2\u65e0\u597d\u53cb\u4e86</li>'),!0})}):"group"===t.type&&layui.each(C.group,function(e,a){if(t.id==a.id)return l.children("li").eq(e).remove(),C.group.splice(e,1),0===C.group.length&&l.html('<li class="layim-null">\u6682\u65e0\u7fa4\u7ec4</li>'),!0}))},j=function(){var e=T().elem.find(".layim-chat-main"),a=e.find("ul"),i=a.children(".layim-chat-li");20<=i.length&&((i=i.eq(0)).prev().remove(),a.prev().hasClass("layim-chat-system")||a.before('<div class="layim-chat-system"><span layim-event="chatLog">\u67e5\u770b\u66f4\u591a\u8bb0\u5f55</span></div>'),i.remove()),e.scrollTop(e[0].scrollHeight+1e3)},P=function(){var a=T().textarea,i=a.next();a.off("keyup").on("keyup",function(e){13===e.keyCode&&(e.preventDefault(),_()),i[""===a.val()?"addClass":"removeClass"]("layui-disabled")})},D={"\u543c\u543c":"^O^","\u60ca\u8bb6":"w(\uff9f\u0414\uff9f)w","\u4e0d\u5c51":" (\uffe3_,\uffe3 )","\u597d\u8036":"\u30fd(\u273f\uff9f\u25bd\uff9f)\u30ce","\u4eb2":"o(*\uffe33\uffe3)o","\u68d2":"(\u0e51\u2022\u0300\u3142\u2022\u0301)\u0648\u2727","\u6da8":"  (\uffe3\ufe36\uffe3)\u2197","\u5f97\u610f":"<(\uffe3\ufe36\uffe3)>","\u6316\u9f3b\u5b54":" (*\uffe3r\u01d2\uffe3)","\u60ca":"\u2299\u02cd\u2299","\u98de":"\ufe3f(\uffe3\ufe36\uffe3)\ufe3f","\u54fc\u54fc":"o(\uffe3\u30d8\uffe3o\uff03)","\u597d\u6ef4":" (u\u203f\u0e3au\u273f\u0e3a)","\u554a\u554a":"\uff2f(\u2267\u53e3\u2266)\uff2f","\u5566\u5566":"\u266a(^\u2207^*)","\u60ca\u559c":"\u2570(*\xb0\u25bd\xb0*)\u256f","\u4e56":" o(*^\uff20^*)o","\u9676\u9189":"( *\ufe3e\u25bd\ufe3e)","\u5582":" (#`O\u2032)","\u6123\u4f4f":" (\xb0\u30fc\xb0\u3003)","\u653e\u5c41":" \u25cb|\uffe3|_ =3","\u53ef\u6076":"\uff08\uff1d\u3002\uff1d\uff09","\u751f\u6c14":" (\u30fc`\u2032\u30fc)","\u6ee1\u8db3":" o(*\uffe3\ufe36\uffe3*)o","\u5d29\u6e83":"o(\u2267\u53e3\u2266)o","\u5443\u5443\u5443":"(\u2299\ufe4f\u2299)","\u6655":"X\ufe4fX","\u5446":" \u2501\u2533\u2501\u3000\u2501\u2533\u2501","\u55b5\u661f\u4eba":" ( =\u2022\u03c9\u2022= )m","\u55b5\u545c":" \u2261\u03c9\u2261","\u718a":"(*\uffe3(\u30a8)\uffe3)","\u5bb3\u7f9e":" (\u273f\u25e1\u203f\u25e1)",good:" o(\uffe3\u25bd\uffe3)\uff44","\u53ef\u7231":"*\uff3e-\uff3e*","\u7206\u7b11":"\u30fe(\u2267\u25bd\u2266*)o","\u5356\u840c":"=\uffe3\u03c9\uffe3="},R=layui.stope,M={chat:function(e){var a=layui.data("layim-mobile")[C.user.id]||{},i=e.data("type"),t=e.data("index"),e=e.attr("data-list")||e.index(),l={};"friend"===i?l=C[i][t].list[e]:"group"===i?l=C[i][e]:"history"===i&&(l=(a.history||{})[t]||{}),l.name=l.name||l.username||l.groupname,"history"!==i&&(l.type=i),L(l,!0),r(".layim-"+l.type+l.id).find(".layim-msg-status").removeClass(p)},spread:function(e){var a=e.attr("lay-type"),i="true"===a?"false":"true",t=layui.data("layim-mobile")[C.user.id]||{};e.next()["true"===a?"removeClass":"addClass"](p),t["spread"+e.parent().index()]=i,layui.data("layim-mobile",{key:C.user.id,value:t}),e.attr("lay-type",i),e.find(".layui-icon").html("true"==i?"&#xe61a;":"&#xe602;")},tab:function(e){var a=e.index(),i=".layim-tab-content";e.addClass(f).siblings().removeClass(f),c.find(i).eq(a).addClass(p).siblings(i).removeClass(p)},back:function(e){var a=e.parents(".layui-m-layer").eq(0),i=a.attr("index"),t=".layim-panel";setTimeout(function(){m.close(i)},300),e.parents(t).eq(0).removeClass("layui-m-anim-left").addClass("layui-m-anim-rout"),a.prev().find(t).eq(0).removeClass("layui-m-anim-lout").addClass("layui-m-anim-right"),layui.each(h.back,function(e,a){setTimeout(function(){a&&a()},200)})},send:function(){_()},face:function(e,a){var i="",t=T(),l=t.textarea,n=(layui.each(D,function(e,a){i+='<li title="'+e+'">'+a+"</li>"}),i='<ul class="layui-layim-face">'+i+"</ul>",m.popBottom({content:i,success:function(e){e=r(e).find(".layui-layim-face").children("li");s(e,function(){return d(t.textarea[0],this.innerHTML+" ",!0),l.next()[""===l.val()?"addClass":"removeClass"]("layui-disabled"),!1})}}),r(document));v?s(n,function(){M.faceHide()}):n.off("click",M.faceHide).on("click",M.faceHide),R(a)},faceHide:function(){m.close(m.popBottom.index),r(document).off("touchend",M.faceHide).off("click",M.faceHide)},image:function(e){var a=e.data("type")||"images",i=T(),t=C.base[{images:"uploadImage",file:"uploadFile"}[a]]||{};layui.upload.render({url:t.url||"",method:t.type,elem:e.find("input")[0],accept:a,done:function(e){0==e.code?(e.data=e.data||{},"images"===a?d(i.textarea[0],"img["+(e.data.src||"")+"]"):"file"===a&&d(i.textarea[0],"file("+(e.data.src||"")+")["+(e.data.name||"\u4e0b\u8f7d\u6587\u4ef6")+"]"),_()):m.msg(e.msg||"\u4e0a\u4f20\u5931\u8d25")}})},extend:function(i){var e=i.attr("lay-filter"),t=T();layui.each(h["tool("+e+")"],function(e,a){a&&a.call(i,function(e){d(t.textarea[0],e)},_,t)})},newFriend:function(){layui.each(h.newFriend,function(e,a){a&&a()})},group:function(){S({title:"\u7fa4\u804a",tpl:['<div class="layui-layim-list layim-list-group">',g({type:"group",item:"d.group"}),"</div>"].join(""),data:{}})},detail:function(){var i=T();layui.each(h.detail,function(e,a){a&&a(i.data)})},playAudio:function(e){function a(){t.pause(),e.removeAttr("status"),e.find("i").html("&#xe652;")}var i=e.data("audio"),t=i||document.createElement("audio");return e.data("error")?m.msg("\u64ad\u653e\u97f3\u9891\u6e90\u5f02\u5e38"):t.play?void(e.attr("status")?a():(i||(t.src=e.data("src")),t.play(),e.attr("status","pause"),e.data("audio",t),e.find("i").html("&#xe651;"),t.onended=function(){a()},t.onerror=function(){m.msg("\u64ad\u653e\u97f3\u9891\u6e90\u5f02\u5e38"),e.data("error",!0),a()})):m.msg("\u60a8\u7684\u6d4f\u89c8\u5668\u4e0d\u652f\u6301audio")},playVideo:function(e){e=e.data("src");if(!document.createElement("video").play)return m.msg("\u60a8\u7684\u6d4f\u89c8\u5668\u4e0d\u652f\u6301video");m.close(M.playVideo.index),M.playVideo.index=m.open({type:1,anim:!1,style:"width: 100%; height: 50%;",content:'<div style="background-color: #000; height: 100%;"><video style="position: absolute; width: 100%; height: 100%;" src="'+e+'" autoplay="autoplay"></video></div>'})},chatLog:function(e){var i=T();layui.each(h.chatlog,function(e,a){a&&a(i.data,i.elem.find(".layim-chat-main>ul"))})},moreList:function(e){var i=e.attr("lay-filter");layui.each(h.moreList,function(e,a){a&&a({alias:i})})},about:function(){m.open({content:'<p style="padding-bottom: 5px;">\u7248\u672c\uff1a v3.9.9</p>',className:"layim-about",shadeClose:!1,btn:"\u6211\u77e5\u9053\u4e86"})}};e("layim-mobile",new a)}).link(layui.cache.layimResPath+"mobile.css","skinlayim-mobilecss");