{"version":3,"file":"index.min.js","mappings":"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","sources":["webpack://NPlayerDanmaku/webpack/universalModuleDefinition","webpack://NPlayerDanmaku/./packages/nplayer-danmaku/src/scss/index.scss","webpack://NPlayerDanmaku/./node_modules/css-loader/dist/runtime/api.js","webpack://NPlayerDanmaku/./node_modules/css-loader/dist/runtime/noSourceMaps.js","webpack://NPlayerDanmaku/./packages/nplayer-danmaku/src/scss/index.scss?abb8","webpack://NPlayerDanmaku/webpack/bootstrap","webpack://NPlayerDanmaku/webpack/runtime/compat get default export","webpack://NPlayerDanmaku/webpack/runtime/define property getters","webpack://NPlayerDanmaku/webpack/runtime/hasOwnProperty shorthand","webpack://NPlayerDanmaku/webpack/runtime/make namespace object","webpack://NPlayerDanmaku/./packages/nplayer-danmaku/src/ts/utils.ts","webpack://NPlayerDanmaku/./packages/nplayer-danmaku/src/ts/danmaku/bullet.ts","webpack://NPlayerDanmaku/./packages/nplayer-danmaku/src/ts/danmaku/index.ts","webpack://NPlayerDanmaku/./packages/nplayer-danmaku/src/ts/send-box.ts","webpack://NPlayerDanmaku/./packages/nplayer-danmaku/src/ts/setting.ts","webpack://NPlayerDanmaku/./packages/nplayer-danmaku/src/ts/main.ts"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"NPlayerDanmaku\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"NPlayerDanmaku\"] = factory();\n\telse\n\t\troot[\"NPlayerDanmaku\"] = factory();\n})(this, function() {\nreturn ","// Imports\nimport ___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___ from \"../../../../node_modules/css-loader/dist/runtime/noSourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \".nplayer_danmaku_screen{bottom:0;left:0;overflow:hidden;pointer-events:none;position:absolute;right:0;top:0}.nplayer_danmaku_send{align-items:center;background:rgba(255,255,255,.15);display:flex;flex:1;font-size:0;margin:0 10px!important}.nplayer_danmaku_send input{background:transparent;border:0;color:currentColor;flex:1;font-size:13px;outline:0;padding:0;width:100px}.nplayer_danmaku_send input::-moz-placeholder{color:rgba(255,255,255,.5)}.nplayer_danmaku_send input:-ms-input-placeholder{color:rgba(255,255,255,.5)}.nplayer_danmaku_send input::placeholder{color:rgba(255,255,255,.5)}.nplayer_danmaku_send_btn{cursor:pointer;font-size:12px;padding:0 10px;white-space:nowrap}.nplayer_danmaku_send .nplayer_popover_panel{font-size:13px;padding:0 15px}.nplayer_danmaku_send .nplayer_checkbox{margin-top:3px}.nplayer_danmaku_send .nplayer_checkbox+.nplayer_checkbox{margin-left:10px}.nplayer_danmaku_colors{align-items:center;display:flex;flex-wrap:wrap;padding-bottom:12px}.nplayer_danmaku_color{height:19px;margin-bottom:5px;margin-right:5px;width:19px}.nplayer_danmaku_color_row{align-items:stretch;display:flex;margin:5px 0}.nplayer_danmaku_color_row input{border:1px solid rgba(255,255,255,.8);flex:3;letter-spacing:1px;padding:0 5px;width:0}.nplayer_danmaku_color_preview{flex:2;height:20px;margin-left:5px}.nplayer_danmaku_color:hover{transform:scale(1.1)}.nplayer_danmaku_row{justify-content:space-between;margin:12px 0}.nplayer_danmaku_onoff_label{margin-right:5px;margin-top:-2px}.nplayer_danmaku_reset{border:1px solid rgba(255,255,255,.5);margin-left:auto;padding:2px 5px;transition:opacity .2s ease}.nplayer_danmaku_reset:hover{opacity:.7}.nplayer_danmaku_setting{font-size:13px;padding:10px 20px}.nplayer_danmaku_setting .nplayer_slider{margin:3px 12px}.nplayer_danmaku_setting .nplayer_checkbox{margin-top:5px}.nplayer_danmaku_setting .nplayer_checkbox+.nplayer_checkbox{margin-left:15px}.nplayer_danmaku_item{color:#fff;letter-spacing:1px;line-height:1.125;position:absolute;text-shadow:#000 1px 0 1px,#000 0 1px 1px,#000 0 -1px 1px,#000 -1px 0 1px;white-space:nowrap;will-change:transform}.nplayer_danmaku_item-center{left:50%;transform:translateX(-50%);will-change:auto;z-index:1}.nplayer_danmaku_item-me{outline:2px solid;z-index:2}\", \"\"]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","\"use strict\";\n\n/*\n  MIT License http://www.opensource.org/licenses/mit-license.php\n  Author Tobias Koppers @sokra\n*/\nmodule.exports = function (cssWithMappingToString) {\n  var list = []; // return the list of modules as css string\n\n  list.toString = function toString() {\n    return this.map(function (item) {\n      var content = \"\";\n      var needLayer = typeof item[5] !== \"undefined\";\n\n      if (item[4]) {\n        content += \"@supports (\".concat(item[4], \") {\");\n      }\n\n      if (item[2]) {\n        content += \"@media \".concat(item[2], \" {\");\n      }\n\n      if (needLayer) {\n        content += \"@layer\".concat(item[5].length > 0 ? \" \".concat(item[5]) : \"\", \" {\");\n      }\n\n      content += cssWithMappingToString(item);\n\n      if (needLayer) {\n        content += \"}\";\n      }\n\n      if (item[2]) {\n        content += \"}\";\n      }\n\n      if (item[4]) {\n        content += \"}\";\n      }\n\n      return content;\n    }).join(\"\");\n  }; // import a list of modules into the list\n\n\n  list.i = function i(modules, media, dedupe, supports, layer) {\n    if (typeof modules === \"string\") {\n      modules = [[null, modules, undefined]];\n    }\n\n    var alreadyImportedModules = {};\n\n    if (dedupe) {\n      for (var _i = 0; _i < this.length; _i++) {\n        var id = this[_i][0];\n\n        if (id != null) {\n          alreadyImportedModules[id] = true;\n        }\n      }\n    }\n\n    for (var _i2 = 0; _i2 < modules.length; _i2++) {\n      var item = [].concat(modules[_i2]);\n\n      if (dedupe && alreadyImportedModules[item[0]]) {\n        continue;\n      }\n\n      if (typeof layer !== \"undefined\") {\n        if (typeof item[5] === \"undefined\") {\n          item[5] = layer;\n        } else {\n          item[1] = \"@layer\".concat(item[5].length > 0 ? \" \".concat(item[5]) : \"\", \" {\").concat(item[1], \"}\");\n          item[5] = layer;\n        }\n      }\n\n      if (media) {\n        if (!item[2]) {\n          item[2] = media;\n        } else {\n          item[1] = \"@media \".concat(item[2], \" {\").concat(item[1], \"}\");\n          item[2] = media;\n        }\n      }\n\n      if (supports) {\n        if (!item[4]) {\n          item[4] = \"\".concat(supports);\n        } else {\n          item[1] = \"@supports (\".concat(item[4], \") {\").concat(item[1], \"}\");\n          item[4] = supports;\n        }\n      }\n\n      list.push(item);\n    }\n  };\n\n  return list;\n};","\"use strict\";\n\nmodule.exports = function (i) {\n  return i[1];\n};","\n    var isBrowser = typeof window !== 'undefined' && window.document\n    var el;\n\n    function insert() {\n      var style = require(\"!!../../../../node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[1].use[1]!../../../../node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[1].use[2]!../../../../node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[1].use[3]!./index.scss\");\n      if (style.__esModule) style = style.default\n      var css = typeof style === 'string' ? style : style[0][1]\n      var create = false\n      if (!el) {\n        el = document.createElement('style')\n        el.setAttribute('type', 'text/css')\n        create = true\n      }\n\n      if ('textContent' in el) {\n        el.textContent = css\n      } else {\n        el.styleSheet.cssText = css\n      }\n\n      if (create) document.head.appendChild(el)\n    }\n\n    if (isBrowser) insert()\n\n    if (module.hot && isBrowser) {\n      module.hot.accept(\"!!../../../../node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[1].use[1]!../../../../node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[1].use[2]!../../../../node_modules/sass-loader/dist/cjs.js??ruleSet[1].rules[1].use[3]!./index.scss\", function() {\n        insert()\n      });\n      module.hot.dispose(function() {\n        if (el) el.parentNode.removeChild(el)\n      });\n    }\n  ","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\tid: moduleId,\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = function(module) {\n\tvar getter = module && module.__esModule ?\n\t\tfunction() { return module['default']; } :\n\t\tfunction() { return module; };\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","// define __esModule on exports\n__webpack_require__.r = function(exports) {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","import { DanmakuOptions } from './danmaku';\n\nexport function isDefaultColor(color: string): boolean {\n  if (!color) return true;\n  if (typeof color !== 'string') return false;\n  color = color.toLowerCase();\n  return color === '#fff' || color === '#ffffff';\n}\n\nexport function createTimer() {\n  return {\n    _prevPauseTime: 0,\n    _pausedTime: 0,\n    _paused: false,\n\n    now() {\n      return ((this._paused ? this._prevPauseTime : Date.now()) - this._pausedTime) / 1000;\n    },\n\n    play() {\n      if (!this._paused) return;\n      this._pausedTime += (Date.now() - this._prevPauseTime);\n      this._paused = false;\n    },\n\n    pause() {\n      if (this._paused) return;\n      this._prevPauseTime = Date.now();\n      this._paused = true;\n    },\n  };\n}\n\nconst storageKey = 'nplayer:danmaku';\nexport function getStorageOptions(): DanmakuOptions | undefined {\n  try {\n    const optStr = window.localStorage.getItem(storageKey);\n    if (!optStr) return;\n    return JSON.parse(optStr);\n  } catch (error) {\n    // ignore\n  }\n}\nexport function setStorageOptions(opts: DanmakuOptions) {\n  try {\n    window.localStorage.setItem(storageKey, JSON.stringify(opts));\n  } catch (error) {\n    // ignore\n  }\n}\n\nexport const SEND_SETTINGS = 'Send settings';\nexport const SEND = 'Send';\nexport const MODE = 'Mode';\nexport const SCROLL = 'Scroll';\nexport const TOP = 'Top';\nexport const BOTTOM = 'Bottom';\nexport const COLOR = 'Color';\nexport const COLOUR = 'Color';\nexport const DANMAKU_SETTINGS = 'Danmaku settings';\nexport const ONOFF = 'On/Off';\nexport const RESTORE = 'Restore settings';\nexport const BLOCK_BT = 'Block by type';\nexport const OPACITY = 'Opacity &nbsp;';\nexport const DISPLAY_A = 'Area &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;';\nexport const HALF_S = 'Half';\nexport const FULL_S = 'Full';\nexport const DANMAKU_S = 'Speed &nbsp;&nbsp;&nbsp;';\nexport const SLOW = 'Slow';\nexport const FAST = 'Fast';\nexport const FONTSIZE = 'Font size';\nexport const SMALL = 'Small';\nexport const BIG = 'Big';\nexport const UNLIMITED = 'Unlimited';\nexport const BOTTOM_TT = 'Bottom to top';\n\nexport const trans = {\n  [SEND_SETTINGS]: '发送设置',\n  [SEND]: '发送',\n  [MODE]: '模式',\n  [SCROLL]: '滚动',\n  [TOP]: '顶部',\n  [BOTTOM]: '底部',\n  [COLOR]: '颜色',\n  [COLOUR]: '彩色',\n  [DANMAKU_SETTINGS]: '弹幕设置',\n  [ONOFF]: '开/关',\n  [RESTORE]: '恢复默认设置',\n  [BLOCK_BT]: '按类型屏蔽',\n  [OPACITY]: '不透明度',\n  [DISPLAY_A]: '显示区域',\n  [HALF_S]: '半屏',\n  [FULL_S]: '全屏',\n  [DANMAKU_S]: '弹幕速度',\n  [SLOW]: '慢',\n  [FAST]: '快',\n  [FONTSIZE]: '字体大小',\n  [SMALL]: '小',\n  [BIG]: '大',\n  [UNLIMITED]: '不限弹幕',\n  [BOTTOM_TT]: '从下到上',\n};\n\nexport const EVENT = {\n  DANMAKU_SEND: 'DanmakuSend',\n  DANMAKU_UPDATE_OPTIONS: 'DanmakuUpdateOptions',\n} as const;\n","import type { Danmaku } from '.';\n\nexport interface BulletOption {\n  color?: string;\n  text: string;\n  time: number;\n  type?: 'top' | 'bottom' | 'scroll';\n  isMe?: boolean;\n  force?: boolean;\n}\n\nexport interface BulletSetting {\n  track: number;\n  // eslint-disable-next-line no-use-before-define\n  prev?: Bullet;\n}\n\nconst itemClass = 'nplayer_danmaku_item';\n\nexport class Bullet {\n  readonly el: HTMLElement;\n\n  width = 0;\n\n  left = 0;\n\n  length = 0; // w + l\n\n  startAt = 0;\n\n  showAt = 0;\n\n  endAt = 0;\n\n  speed = 0;\n\n  track = 0;\n\n  type!: string;\n\n  ended = false;\n\n  color = '';\n\n  private centerTimer!: any;\n\n  constructor(container: HTMLElement, private danmaku: Danmaku, opts: BulletOption, setting: BulletSetting) {\n    this.el = container.appendChild(document.createElement('div'));\n    this.el.className = itemClass;\n    this.init(opts, setting);\n  }\n\n  init(opts: BulletOption, setting: BulletSetting): this {\n    this.el.textContent = opts.text;\n    this.type = opts.type || 'scroll';\n    this.track = setting.track;\n    if (opts.color) this.el.style.color = this.color = opts.color;\n    if (opts.isMe) this.el.classList.add('nplayer_danmaku_item-me');\n    const style = this.el.style;\n    style.fontSize = `${this.danmaku.fontsize}px`;\n\n    this.startAt = this.danmaku.timer.now();\n\n    if (this.type === 'scroll') {\n      this.el.addEventListener('transitionend', this.end);\n      const rect = this.el.getBoundingClientRect();\n      this.width = (this.danmaku.heightGtWidth ? rect.height : rect.width) + 20;\n      const danmakuWidth = this.danmaku.width;\n      const prev = setting.prev;\n      this.left = danmakuWidth;\n      this.speed = this.danmaku.speedScale * (danmakuWidth + this.width) / this.danmaku.opts.duration;\n\n      if (prev && !prev.ended) {\n        const s = (prev.length - danmakuWidth) - (this.startAt - prev.startAt) * prev.speed;\n        if (s >= 0) {\n          this.speed = prev.speed;\n          this.left += s;\n        } else {\n          const maxSpeed = this.danmaku.width / (prev.endAt - this.startAt);\n          if (this.speed > maxSpeed) this.speed = maxSpeed;\n        }\n      }\n\n      this.length = this.left + this.width;\n      const t = this.length / this.speed;\n      this.showAt = this.startAt + (this.length - danmakuWidth) / this.speed;\n      this.endAt = this.startAt + t;\n\n      this.updateScrollY();\n      style.left = `${this.left}px`;\n      style.transition = `transform ${t}s linear`;\n      style.transform = `translate3d(-${this.length}px,0,0)`;\n    } else {\n      style[this.type as any] = this.pos();\n      this.el.classList.add('nplayer_danmaku_item-center');\n      const duration = this.danmaku.speedScale * this.danmaku.opts.duration;\n      this.endAt = this.startAt + duration;\n      this.centerTimer = setTimeout(this.end, duration * 1000);\n    }\n\n    this.ended = false;\n    this.show();\n\n    if (this.danmaku.paused) this.pause(this.startAt);\n\n    return this;\n  }\n\n  private pos(): string {\n    return `${this.track * this.danmaku.trackHeight + 2}px`;\n  }\n\n  updateScrollY(bottomUp = this.danmaku.opts.bottomUp) {\n    if (this.type !== 'scroll') return;\n    const style = this.el.style;\n    style.top = style.bottom = '';\n    style[bottomUp ? 'bottom' : 'top'] = this.pos();\n  }\n\n  end = () => {\n    this.el.removeEventListener('transitionend', this.end);\n    clearTimeout(this.centerTimer);\n    this.el.style.cssText = '';\n    this.color = '';\n    this.el.className = itemClass;\n    this.ended = true;\n    this.hide();\n    this.danmaku.recycleBullet(this);\n  }\n\n  show() {\n    this.el.style.visibility = '';\n  }\n\n  hide() {\n    this.el.style.visibility = 'hidden';\n  }\n\n  pause(time: number): void {\n    if (this.type === 'scroll') {\n      const style = this.el.style;\n      style.transition = 'transform 0s linear';\n      style.transform = `translate3d(-${(time - this.startAt) * this.speed}px,0,0)`;\n    } else {\n      clearTimeout(this.centerTimer);\n    }\n  }\n\n  run(time: number): void {\n    if (this.type === 'scroll') {\n      const style = this.el.style;\n      style.transition = `transform ${this.endAt - time}s linear`;\n      style.transform = `translate3d(-${this.length}px,0,0)`;\n    } else {\n      this.centerTimer = setTimeout(this.end, (this.endAt - time) * 1000);\n    }\n  }\n}\n","import type { Disposable, Player } from 'nplayer';\nimport {\n  getStorageOptions, isDefaultColor, setStorageOptions, createTimer, EVENT,\n} from '../utils';\nimport { Bullet, BulletOption, BulletSetting } from './bullet';\n\nexport interface DanmakuOptions {\n  disable?: boolean;\n  blocked?: Array<'scroll' | 'top' | 'bottom' | 'color'>;\n  fontsize?: number;\n  fontsizeScale?: number;\n  opacity?: number;\n  speed?: number;\n  area?: 0.25 | 0.5 | 0.75 | 1;\n  unlimited?: boolean;\n  bottomUp?: boolean;\n  colors?: string[];\n  duration?: number;\n  items?: BulletOption[];\n  zIndex?: number;\n  persistOptions?: boolean;\n  maxPerInsert?: number;\n  poolSize?: number;\n  isDefaultColor?: (color: string) => boolean;\n  discard?: (b: BulletOption) => boolean;\n}\n\nexport const defaultOptions = (): Required<DanmakuOptions> => ({\n  disable: false,\n  blocked: [],\n  fontsize: 24,\n  fontsizeScale: 1,\n  opacity: 1,\n  speed: 1,\n  area: 0.5,\n  unlimited: false,\n  bottomUp: false,\n  colors: ['#FE0302', '#FF7204', '#FFAA02', '#FFD302', '#FFFF00', '#A0EE00', '#00CD00', '#019899', '#4266BE', '#CC0273', '#222222', '#FFFFFF'],\n  duration: 5,\n  items: [],\n  zIndex: 5,\n  persistOptions: false,\n  isDefaultColor,\n  maxPerInsert: 20,\n  poolSize: 50,\n  discard() { return false; },\n});\n\nexport class Danmaku implements Disposable {\n  el: HTMLElement;\n\n  opts: Required<DanmakuOptions>;\n\n  enabled = false;\n\n  paused = false;\n\n  track = 0;\n\n  trackHeight = 0;\n\n  timer: ReturnType<typeof createTimer>;\n\n  heightGtWidth = false;\n\n  private probeEl: HTMLElement;\n\n  private bulletPool: Bullet[] = [];\n\n  private aliveBullets: Set<Bullet> = new Set();\n\n  private scrollBullets: (Bullet | undefined)[] = [];\n\n  private topBullets: number[] = [];\n\n  private bottomBullets: number[] = [];\n\n  private items: BulletOption[] = [];\n\n  private pos = 0;\n\n  private prevPauseTime = 0;\n\n  constructor(private player: Player, private _opts?: DanmakuOptions) {\n    this.opts = { ...defaultOptions(), ...getStorageOptions(), ..._opts };\n\n    const { $, addDisposable } = player.Player.__utils;\n    this.el = player.el.appendChild($('.danmaku_screen'));\n    this.el.style.zIndex = String(this.opts.zIndex);\n\n    this.probeEl = this.el.appendChild($());\n    const probeElStyle = this.probeEl.style;\n    probeElStyle.position = 'absolute';\n    probeElStyle.zIndex = '-9';\n    probeElStyle.width = '2px';\n    probeElStyle.height = '1px';\n    probeElStyle.opacity = '0';\n\n    this.items = Array.isArray(this.opts.items) ? this.opts.items : [];\n\n    this.timer = createTimer();\n\n    if (!this.opts.disable) this.enable();\n\n    addDisposable(this, player.on(player.EVENT.MOUNTED, this.updateTrack));\n    addDisposable(this, player.on(player.EVENT.UPDATE_SIZE, this.updateTrack));\n\n    addDisposable(player, this);\n  }\n\n  get width(): number {\n    return this.heightGtWidth ? this.player.rect.height : this.player.rect.width;\n  }\n\n  get currentTime(): number {\n    return this.player.currentTime;\n  }\n\n  get playbackRate(): number {\n    return this.player.playbackRate;\n  }\n\n  get fontsize(): number {\n    return this.opts.fontsize * this.opts.fontsizeScale;\n  }\n\n  get speedScale(): number {\n    return this.playbackRate * this.opts.speed;\n  }\n\n  private createBullet(item: BulletOption, setting: BulletSetting): Bullet {\n    let bullet = this.bulletPool.pop();\n    if (bullet) {\n      bullet.init(item, setting);\n    } else {\n      bullet = new Bullet(this.el, this, item, setting);\n    }\n    this.aliveBullets.add(bullet);\n    return bullet;\n  }\n\n  private unmountBullet(bullet: Bullet) {\n    if (bullet.el && bullet.el.parentNode) {\n      bullet.el.parentNode.removeChild(bullet.el);\n    }\n  }\n\n  private getShortestTrack(): [number, Bullet | undefined] {\n    let shortest = this.scrollBullets[0];\n    if (!shortest || shortest.ended) return [0] as any;\n    for (let i = 1, item; i < this.track; ++i) {\n      item = this.scrollBullets[i];\n      if (!item || item.ended) return [i] as any;\n      if (shortest.showAt > item.showAt) shortest = item;\n    }\n    return [shortest.track, shortest];\n  }\n\n  private getEmptyTrack(time: number, list: number[]): number {\n    for (let i = 0; i < this.track; ++i) {\n      if (!list[i] || list[i] <= time) return i;\n    }\n    return -1;\n  }\n\n  private shouldDiscard(item: BulletOption): boolean {\n    if (this.opts.blocked.includes(item.type || 'scroll')) return true;\n    if (this.opts.discard(item)) return true;\n    if (!item.color || !this.opts.blocked.includes('color')) return false;\n    return !this.opts.isDefaultColor(item.color);\n  }\n\n  private fire = () => {\n    if (!this.enabled || !this.player.playing) return;\n    if (this.paused) this.resume();\n    const currentTime = this.currentTime;\n    const inc = this.opts.unlimited ? 0.5 : 1;\n    const min = currentTime - inc;\n    const max = currentTime + inc;\n    const time = this.timer.now();\n    for (let l = this.items.length, count = 0, maxI = this.opts.maxPerInsert, item: BulletOption; this.pos < l; this.pos++) {\n      item = this.items[this.pos];\n      if (item.time < min) continue;\n      if (item.time > max) break;\n      if (this.shouldDiscard(item)) continue;\n      if (!this.insert(item, time)) break;\n      count++;\n      if (count > maxI) break;\n    }\n  }\n\n  private updateTrack = (): void => {\n    const { width: w, height: h } = this.probeEl.getBoundingClientRect();\n    this.heightGtWidth = h > w;\n    const height = this.heightGtWidth ? this.player.rect.width : this.player.rect.height;\n    this.trackHeight = this.fontsize + 5;\n    this.track = Math.floor(height * this.opts.area / this.trackHeight);\n  }\n\n  private onSeeked = () => {\n    this.clearScreen();\n    this.pos = 0;\n  }\n\n  private storeOptions() {\n    this.player.emit(EVENT.DANMAKU_UPDATE_OPTIONS, this.opts);\n    if (this.opts.persistOptions) {\n      const opts = this.opts;\n      setStorageOptions({\n        blocked: opts.blocked,\n        fontsizeScale: opts.fontsizeScale,\n        opacity: opts.opacity,\n        speed: opts.speed,\n        area: opts.area,\n        unlimited: opts.unlimited,\n        bottomUp: opts.bottomUp,\n      } as DanmakuOptions);\n    }\n  }\n\n  recycleBullet(bullet: Bullet): void {\n    if (this.bulletPool.length > this.opts.poolSize) {\n      this.unmountBullet(bullet);\n    } else {\n      this.bulletPool.push(bullet);\n    }\n    this.aliveBullets.delete(bullet);\n    if (bullet.type === 'scroll' && this.scrollBullets[bullet.track] === bullet) this.scrollBullets[bullet.track] = undefined;\n  }\n\n  private insert(item: BulletOption, time: number): boolean {\n    if (!item.type || item.type === 'scroll') {\n      const [track, bullet] = this.getShortestTrack();\n      const canDiscard = !item.force && bullet && bullet.showAt > (time + 2);\n      if (canDiscard && !this.opts.unlimited) return false;\n      this.scrollBullets[track] = this.createBullet(item, { track, prev: canDiscard ? undefined : bullet });\n      return true;\n    }\n\n    const list = item.type === 'top' ? this.topBullets : this.bottomBullets;\n    let track = this.getEmptyTrack(time, list);\n    track = track === -1 && item.force ? 0 : track;\n    if (track !== -1) {\n      list[track] = this.createBullet(item, { track }).endAt;\n      return true;\n    }\n    return false;\n  }\n\n  send(opts: BulletOption): void {\n    if (opts.time == null) opts.time = this.currentTime;\n    opts = { isMe: true, force: true, ...opts };\n    this.player.emit(EVENT.DANMAKU_SEND, opts);\n    const i = this.addItem(opts);\n    if (this.pos > i) {\n      this.insert(opts, this.timer.now());\n    }\n  }\n\n  pause = () => {\n    this.prevPauseTime = this.timer.now();\n    this.timer.pause();\n    this.aliveBullets.forEach((bullet) => bullet.pause(this.prevPauseTime));\n    this.paused = true;\n  }\n\n  resume = () => {\n    if (!this.player.playing || this.player.loading.isActive) {\n      return;\n    }\n\n    this.timer.play();\n    this.aliveBullets.forEach((bullet) => bullet.run(this.prevPauseTime));\n    this.paused = false;\n  }\n\n  getItems(): BulletOption[] {\n    return this.items;\n  }\n\n  addItem(opts: BulletOption): number {\n    if (opts.time == null) return -1;\n\n    const l = this.items.length;\n    if (!l || opts.time >= this.items[l - 1].time) {\n      this.items.push(opts);\n      return l;\n    }\n    if (opts.time <= this.items[0].time) {\n      this.items.unshift(opts);\n      return 0;\n    }\n\n    let index = 0;\n    for (let i = 0; i < l; i++) {\n      if (this.items[i].time > opts.time) {\n        index = i;\n        break;\n      }\n    }\n\n    this.items.splice(index, 0, opts);\n    return index;\n  }\n\n  appendItems(items: BulletOption[]): void {\n    this.items = this.items.concat(items);\n  }\n\n  resetItems(items: BulletOption[]): void {\n    this.items = items;\n    this.pos = 0;\n  }\n\n  updateOpacity(opacity = this.opts.opacity): void {\n    this.el.style.opacity = String(opacity);\n    this.storeOptions();\n  }\n\n  updateFontsize(scale = this.opts.fontsizeScale): void {\n    this.opts.fontsizeScale = scale;\n    this.updateTrack();\n    this.storeOptions();\n  }\n\n  updateArea(area: Required<DanmakuOptions>['area']): void {\n    if (![0.25, 0.5, 0.75, 1].includes(area)) return;\n    this.opts.area = area;\n    this.updateTrack();\n    this.storeOptions();\n  }\n\n  updateUnlimited(unlimited: boolean): void {\n    this.opts.unlimited = unlimited;\n    this.storeOptions();\n  }\n\n  updateBottomUp(bottomUp: boolean): void {\n    this.opts.bottomUp = bottomUp;\n    this.aliveBullets.forEach((b) => b.updateScrollY(bottomUp));\n    this.storeOptions();\n  }\n\n  updateSpeed(v: number): void {\n    this.opts.speed = v;\n    this.storeOptions();\n  }\n\n  blockType(type: Required<DanmakuOptions>['blocked'][0]): void {\n    if (this.opts.blocked.includes(type)) return;\n    this.opts.blocked.push(type);\n    this.aliveBullets.forEach((b) => {\n      if (b.type === type || (type === 'color' && !this.opts.isDefaultColor(b.color))) {\n        b.hide();\n      }\n    });\n    this.storeOptions();\n  }\n\n  allowType(type: Parameters<Danmaku['blockType']>[0]): void {\n    this.opts.blocked = this.opts.blocked.filter((t) => t !== type);\n    this.aliveBullets.forEach((b) => {\n      if (b.type === type || (type === 'color' && !this.opts.isDefaultColor(b.color))) {\n        b.show();\n      }\n    });\n    this.storeOptions();\n  }\n\n  resetOptions(): void {\n    this.opts.blocked.forEach((t) => {\n      this.allowType(t);\n    });\n    this.opts = { ...defaultOptions(), ...this._opts };\n    this.opts.blocked = [];\n    this.updateOpacity();\n    this.updateFontsize();\n    this.updateBottomUp(this.opts.bottomUp);\n  }\n\n  clearScreen() {\n    Array.from(this.aliveBullets).forEach((b) => b.end());\n    this.topBullets = [];\n    this.bottomBullets = [];\n  }\n\n  enable(): void {\n    if (this.enabled) return;\n    this.enabled = true;\n    const EV = this.player.EVENT;\n    this.player.on(EV.TIME_UPDATE, this.fire);\n    this.player.on(EV.PAUSE, this.pause);\n    this.player.on(EV.ENDED, this.pause);\n    this.player.on(EV.PLAY, this.resume);\n    this.player.on(EV.SEEKED, this.onSeeked);\n    this.player.on(EV.LOADING_SHOW, this.pause);\n    this.player.on(EV.LOADING_HIDE, this.resume);\n  }\n\n  disable(): void {\n    this.enabled = false;\n    this.clearScreen();\n    const EV = this.player.EVENT;\n    this.player.off(EV.TIME_UPDATE, this.fire);\n    this.player.off(EV.PAUSE, this.pause);\n    this.player.off(EV.ENDED, this.pause);\n    this.player.off(EV.PLAY, this.resume);\n    this.player.off(EV.SEEKED, this.onSeeked);\n    this.player.off(EV.LOADING_SHOW, this.pause);\n    this.player.off(EV.LOADING_HIDE, this.resume);\n  }\n\n  dispose(): void {\n    if (!this.player) return;\n    this.disable();\n    this.player.Player.__utils.removeNode(this.el);\n    this.player.Player.__utils.dispose(this);\n    this.player = null!;\n    this.bulletPool = null!;\n    this.aliveBullets = null!;\n    this.scrollBullets = null!;\n    this.topBullets = null!;\n    this.bottomBullets = null!;\n    this.items = null!;\n    this.el = null!;\n    this.opts = null!;\n  }\n\n  EVENT!: typeof EVENT\n}\n\nDanmaku.prototype.EVENT = EVENT;\n","import type {\n  Checkbox,\n  ControlItem,\n  Player, Popover, Tooltip,\n} from 'nplayer';\nimport { BulletOption } from './danmaku/bullet';\nimport {\n  BOTTOM, COLOR, isDefaultColor, MODE, SCROLL, SEND, SEND_SETTINGS, TOP,\n} from './utils';\n\nlet utils: Player['Player']['__utils'];\n\nclass DanmakuSendBox implements ControlItem {\n  readonly id = 'danmaku-send';\n\n  el!: HTMLElement;\n\n  private player!: Player\n\n  tooltip!: Tooltip;\n\n  private popover!: Popover;\n\n  private inputEl!: HTMLInputElement;\n\n  private sendEl!: HTMLElement;\n\n  private colorInputEl!: HTMLInputElement;\n\n  private colorEl!: HTMLElement;\n\n  private typeCBs: Record<Required<BulletOption>['type'], Checkbox> = {} as any;\n\n  private currentType = 'scroll';\n\n  init(player: Player, position: number) {\n    this.player = player;\n    const { __utils, components, I18n } = player.Player;\n    utils = __utils;\n    const {\n      $, addDisposableListener, addDisposable, createSvg,\n    } = utils;\n\n    this.el = $('.danmaku_send');\n    const settingElement = this.el.appendChild($());\n    settingElement.appendChild(createSvg('icon', 'M9.62 14L12 7.67 14.37 14M11 5L5.5 19h2.25l1.12-3h6.25l1.13 3h2.25L13 5h-2z'));\n    this.tooltip = addDisposable(this, new components.Tooltip(settingElement, I18n.t(SEND_SETTINGS)));\n    this.popover = addDisposable(this, new components.Popover(settingElement, () => this.tooltip.show(), undefined, true));\n    this.inputEl = this.el.appendChild($('input'));\n    this.sendEl = this.el.appendChild($('.danmaku_send_btn', undefined, I18n.t(SEND)));\n\n    this.setPos(position);\n\n    const row = () => $('.flex.align-center.danmaku_row');\n    const panelElement = this.popover.panelEl;\n    let rowElement = $('.danmaku_row');\n    panelElement.appendChild(rowElement);\n    rowElement.appendChild($(undefined, undefined, I18n.t(MODE)));\n    rowElement = rowElement.appendChild($('.flex.align-center'));\n    this.typeCBs.scroll = addDisposable(this, new components.Checkbox(rowElement, { html: I18n.t(SCROLL), checked: true, change: this.onTypeChange('scroll') }));\n    this.typeCBs.top = addDisposable(this, new components.Checkbox(rowElement, { html: I18n.t(TOP), change: this.onTypeChange('top') }));\n    this.typeCBs.bottom = addDisposable(this, new components.Checkbox(rowElement, { html: I18n.t(BOTTOM), change: this.onTypeChange('bottom') }));\n    rowElement = row();\n    rowElement = $('.danmaku_row');\n    panelElement.appendChild(rowElement);\n    rowElement.appendChild($(undefined, undefined, I18n.t(COLOR)));\n    rowElement = rowElement.appendChild($('.danmaku_color_row'));\n    this.colorInputEl = rowElement.appendChild($('input'));\n    addDisposableListener(this, this.colorInputEl, 'input', () => {\n      this.updateColor(this.colorInputEl.value);\n    });\n    this.colorEl = rowElement.appendChild($('.danmaku_color_preview'));\n    rowElement = $('.danmaku_colors');\n    addDisposableListener(this, rowElement, 'click', ({ target }: MouseEvent) => {\n      const el = target as HTMLElement;\n      if (el && el.dataset.value) {\n        this.updateColor(el.dataset.value);\n      }\n    });\n    let colorItem;\n    player.danmaku.opts.colors.forEach((c) => {\n      colorItem = $('.danmaku_color');\n      colorItem.style.background = c;\n      colorItem.dataset.value = c;\n      rowElement.appendChild(colorItem);\n    });\n    panelElement.appendChild(rowElement);\n\n    addDisposableListener(this, settingElement, 'click', this.show);\n    addDisposableListener(this, this.inputEl, 'keypress', (ev: KeyboardEvent) => {\n      if (ev.altKey || ev.ctrlKey || ev.metaKey || ev.shiftKey) return;\n      const code = ev.keyCode || ev.which;\n      if (code !== 13) return;\n      this.send();\n    });\n    addDisposableListener(this, this.inputEl, 'focus', () => player.control.require());\n    addDisposableListener(this, this.inputEl, 'blur', () => player.control.release());\n    addDisposableListener(this, this.sendEl, 'click', this.send);\n\n    this.updateColor('#FFFFFF');\n  }\n\n  update(position: number): void {\n    this.setPos(position);\n  }\n\n  private setPos(position: number): void {\n    this.popover.resetPos();\n    if (position === 2) this.popover.setBottom();\n  }\n\n  private onTypeChange = (type: Required<BulletOption>['type']) => () => {\n    this.currentType = type;\n    this.typeCBs.scroll.update(false);\n    this.typeCBs.top.update(false);\n    this.typeCBs.bottom.update(false);\n    this.typeCBs[type].update(true);\n  }\n\n  updateColor(v: string) {\n    this.colorInputEl.value = v;\n    this.colorEl.style.background = v;\n    this.inputEl.style.color = v;\n  }\n\n  show = (ev?: MouseEvent) => {\n    if (ev && utils.getEventPath(ev).includes(this.popover.el)) return;\n    this.tooltip.hide();\n    this.popover.show();\n  }\n\n  send = () => {\n    const value = this.inputEl.value;\n    if (!value) return;\n    this.inputEl.value = '';\n    const bullet: BulletOption = {\n      text: value,\n      time: this.player.currentTime,\n      type: this.currentType as any,\n      color: isDefaultColor(value) ? undefined : this.colorInputEl.value,\n    };\n    this.player.danmaku.send(bullet);\n  }\n\n  dispose() {\n    if (!this.player) return;\n    utils.dispose(this);\n    utils.removeNode(this.el);\n    this.player = null!;\n    this.el = null!;\n  }\n}\n\nexport const danmakuSendBoxControlItem = () => new DanmakuSendBox();\n","import type {\n  Player, Popover, Tooltip, Checkbox, Slider, ControlItem,\n} from 'nplayer';\nimport {\n  BIG, BLOCK_BT, BOTTOM, BOTTOM_TT, COLOUR, DANMAKU_S, DANMAKU_SETTINGS, DISPLAY_A, FAST, FONTSIZE,\n  FULL_S, HALF_S, ONOFF, OPACITY, RESTORE, SCROLL, SLOW, SMALL, TOP, UNLIMITED,\n} from './utils';\n\nclass DanmakuSetting implements ControlItem {\n  readonly id = 'danmaku-settings';\n\n  private player!: Player\n\n  el!: HTMLElement;\n\n  tooltip!: Tooltip;\n\n  private popover!: Popover;\n\n  private scrollCB!: Checkbox;\n\n  private topCB!: Checkbox;\n\n  private bottomCB!: Checkbox;\n\n  private colorCB!: Checkbox;\n\n  private unlimitedCB!: Checkbox;\n\n  private bottomUpCB!: Checkbox;\n\n  private opacitySlider!: Slider;\n\n  private areaSlider!: Slider;\n\n  private speedSlider!: Slider;\n\n  private fontsizeSlider!: Slider;\n\n  init(player: Player, position: number) {\n    this.player = player;\n    const { __utils, components, I18n } = player.Player;\n    const {\n      $, clamp, addDisposableListener, addDisposable, createSvg,\n    } = __utils;\n\n    this.el = $();\n    this.el.appendChild(createSvg('icon', 'M9 21v2H7v-2h2m4 0v2h-2v-2h2m4 0v2h-2v-2h2M2 19V3h20v16m-11-7H9v2h2v-2m8 0h-6v2h6v-2M7 8H5v2h2V8m12 0H9v2h10V8z'));\n    this.tooltip = addDisposable(this, new components.Tooltip(this.el, I18n.t(DANMAKU_SETTINGS)));\n    this.popover = addDisposable(this, new components.Popover(this.el, () => this.tooltip.show()));\n\n    addDisposableListener(this, this.el, 'click', this.show);\n\n    const panelElement = this.popover.panelEl;\n    __utils.addClass(panelElement, 'danmaku_setting');\n\n    this.setPos(position);\n\n    player.on('Mounted', () => {\n      const row = () => $('.flex.align-center.danmaku_row');\n\n      let rowElement = row();\n      rowElement.appendChild($('.danmaku_onoff_label', undefined, I18n.t(ONOFF)));\n      addDisposable(this, new components.Switch(rowElement, player.danmaku.enabled, (v) => player.danmaku[v ? 'enable' : 'disable']()));\n      const resetBtn = rowElement.appendChild($('.danmaku_reset', undefined, I18n.t(RESTORE)));\n      addDisposableListener(this, resetBtn, 'click', () => {\n        player.danmaku.resetOptions();\n        this.updateSettings();\n      });\n      panelElement.appendChild(rowElement);\n      rowElement = $('.danmaku_row');\n      panelElement.appendChild(rowElement);\n      rowElement.appendChild($(undefined, undefined, I18n.t(BLOCK_BT)));\n      rowElement = rowElement.appendChild($('.flex.align-center'));\n      this.scrollCB = addDisposable(this, new components.Checkbox(rowElement, {\n        html: I18n.t(SCROLL),\n        change(v) {\n          player.danmaku[v ? 'blockType' : 'allowType']('scroll');\n        },\n      }));\n      this.topCB = addDisposable(this, new components.Checkbox(rowElement, {\n        html: I18n.t(TOP),\n        change(v) {\n          player.danmaku[v ? 'blockType' : 'allowType']('top');\n        },\n      }));\n      this.bottomCB = addDisposable(this, new components.Checkbox(rowElement, {\n        html: I18n.t(BOTTOM),\n        change(v) {\n          player.danmaku[v ? 'blockType' : 'allowType']('bottom');\n        },\n      }));\n      this.colorCB = addDisposable(this, new components.Checkbox(rowElement, {\n        html: I18n.t(COLOUR),\n        change(v) {\n          player.danmaku[v ? 'blockType' : 'allowType']('color');\n        },\n      }));\n      rowElement = row();\n      rowElement.appendChild($(undefined, undefined, I18n.t(OPACITY)));\n      this.opacitySlider = addDisposable(this, new components.Slider(rowElement, {\n        stops: [{ value: 0, html: '10%' }, { value: 1, html: '100%' }],\n        change(value) {\n          player.danmaku.updateOpacity(clamp(value + 0.1, 0.1, 1));\n        },\n      }));\n      panelElement.appendChild(rowElement);\n      rowElement = row();\n      rowElement.appendChild($(undefined, undefined, I18n.t(DISPLAY_A)));\n      this.areaSlider = addDisposable(this, new components.Slider(rowElement, {\n        stops: [{ value: 0, html: '1/4' }, { value: 0.33, html: I18n.t(HALF_S) }, { value: 0.66, html: '3/4' }, { value: 1, html: I18n.t(FULL_S) }],\n        step: true,\n        change(v) {\n          v = v === 0 ? 0.25 : v === 0.33 ? 0.5 : v === 0.66 ? 0.75 : 1;\n          player.danmaku.updateArea(v as any);\n        },\n      }));\n      panelElement.appendChild(rowElement);\n      rowElement = row();\n      rowElement.appendChild($(undefined, undefined, I18n.t(DANMAKU_S)));\n      this.speedSlider = addDisposable(this, new components.Slider(rowElement, {\n        stops: [{ value: 0, html: I18n.t(SLOW) }, { value: 1, html: I18n.t(FAST) }],\n        change(v) {\n          player.danmaku.updateSpeed(clamp(v + 0.5, 0.5, 1.5));\n        },\n      }));\n      panelElement.appendChild(rowElement);\n      rowElement = row();\n      rowElement.appendChild($(undefined, undefined, I18n.t(FONTSIZE)));\n      this.fontsizeSlider = addDisposable(this, new components.Slider(rowElement, {\n        stops: [{ value: 0, html: I18n.t(SMALL) }, { value: 1, html: I18n.t(BIG) }],\n        change(v) {\n          player.danmaku.updateFontsize(clamp(v + 0.5, 0.5, 1.5));\n        },\n      }));\n      panelElement.appendChild(rowElement);\n      rowElement = row();\n      this.unlimitedCB = addDisposable(this, new components.Checkbox(rowElement, {\n        html: I18n.t(UNLIMITED), change(v) { player.danmaku.updateUnlimited(v); },\n      }));\n      this.bottomUpCB = addDisposable(this, new components.Checkbox(rowElement, {\n        html: I18n.t(BOTTOM_TT), change(v) { player.danmaku.updateBottomUp(v); },\n      }));\n      panelElement.appendChild(rowElement);\n\n      this.updateSettings();\n    });\n  }\n\n  update(position: number): void {\n    this.setPos(position);\n  }\n\n  private setPos(position: number): void {\n    this.popover.resetPos();\n    if (position === 2) this.popover.setBottom();\n  }\n\n  updateSettings() {\n    const opts = this.player.danmaku.opts;\n    this.scrollCB.update(opts.blocked.includes('scroll'));\n    this.topCB.update(opts.blocked.includes('top'));\n    this.bottomCB.update(opts.blocked.includes('bottom'));\n    this.colorCB.update(opts.blocked.includes('color'));\n    this.unlimitedCB.update(opts.unlimited);\n    this.bottomUpCB.update(opts.bottomUp);\n    this.opacitySlider.update(opts.opacity);\n    this.areaSlider.update({\n      0.25: 0, 0.5: 0.33, 0.75: 0.66, 1: 1,\n    }[opts.area]);\n    this.speedSlider.update(opts.speed - 0.5);\n    this.fontsizeSlider.update(opts.fontsizeScale - 0.5);\n  }\n\n  show = () => {\n    this.popover.show();\n    this.tooltip.hide();\n  }\n\n  dispose() {\n    if (!this.player) return;\n    this.player.Player.__utils.dispose(this);\n    this.player.Player.__utils.removeNode(this.el);\n    this.player = null!;\n  }\n}\n\nexport const danmakuSettingControlItem = () => new DanmakuSetting();\n","import type { Plugin as P, Player } from 'nplayer';\nimport { Danmaku, DanmakuOptions } from './danmaku';\nimport { danmakuSendBoxControlItem } from './send-box';\nimport { danmakuSettingControlItem } from './setting';\nimport { trans } from './utils';\n\nexport interface DanmakuPluginOption extends DanmakuOptions {\n  autoInsert: boolean;\n}\n\nexport class Plugin implements P {\n  private opts: DanmakuPluginOption;\n\n  constructor(opts: DanmakuPluginOption) {\n    this.opts = opts;\n  }\n\n  apply(player: Player) {\n    player.registerControlItem(danmakuSendBoxControlItem());\n    player.registerControlItem(danmakuSettingControlItem());\n\n    player.Player.I18n.add('zh-cn', trans);\n    player.danmaku = new Danmaku(player, this.opts);\n\n    if (!player.mounted && this.opts && this.opts.autoInsert !== false) {\n      const i = player.opts.controls[0].findIndex((c) => c === 'spacer');\n      if (i !== -1) {\n        player.opts.controls[0].splice(i, 1, 'danmaku-send', 'danmaku-settings');\n      }\n    }\n  }\n\n  static Plugin = Plugin;\n}\n"],"names":["root","factory","exports","module","define","amd","this","___CSS_LOADER_EXPORT___","push","id","cssWithMappingToString","list","toString","map","item","content","needLayer","concat","length","join","i","modules","media","dedupe","supports","layer","undefined","alreadyImportedModules","_i","_i2","el","window","document","style","__esModule","default","css","create","createElement","setAttribute","textContent","styleSheet","cssText","head","appendChild","insert","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","__webpack_modules__","n","getter","d","a","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","r","Symbol","toStringTag","value","isDefaultColor","color","toLowerCase","storageKey","SEND_SETTINGS","SEND","MODE","SCROLL","TOP","BOTTOM","COLOR","COLOUR","DANMAKU_SETTINGS","ONOFF","RESTORE","BLOCK_BT","OPACITY","DISPLAY_A","HALF_S","FULL_S","DANMAKU_S","SLOW","FAST","FONTSIZE","SMALL","UNLIMITED","BOTTOM_TT","trans","EVENT","DANMAKU_SEND","DANMAKU_UPDATE_OPTIONS","itemClass","Bullet","container","danmaku","opts","setting","removeEventListener","end","clearTimeout","centerTimer","className","ended","hide","recycleBullet","init","text","type","track","isMe","classList","add","fontSize","fontsize","startAt","timer","now","addEventListener","rect","getBoundingClientRect","width","heightGtWidth","height","danmakuWidth","prev","left","speed","speedScale","duration","s","maxSpeed","endAt","t","showAt","updateScrollY","transition","transform","pos","setTimeout","show","paused","pause","trackHeight","bottomUp","top","bottom","visibility","time","utils","defaultOptions","disable","blocked","fontsizeScale","opacity","area","unlimited","colors","items","zIndex","persistOptions","maxPerInsert","poolSize","discard","Danmaku","player","_opts","Set","enabled","playing","resume","currentTime","inc","min","max","l","count","maxI","shouldDiscard","probeEl","w","h","Math","floor","clearScreen","prevPauseTime","aliveBullets","forEach","bullet","loading","isActive","play","run","optStr","localStorage","getItem","JSON","parse","error","getStorageOptions","Player","__utils","$","addDisposable","String","probeElStyle","position","Array","isArray","_prevPauseTime","_pausedTime","_paused","Date","enable","on","MOUNTED","updateTrack","UPDATE_SIZE","playbackRate","bulletPool","pop","parentNode","removeChild","shortest","scrollBullets","includes","emit","setItem","stringify","setStorageOptions","unmountBullet","delete","getShortestTrack","canDiscard","force","createBullet","topBullets","bottomBullets","getEmptyTrack","addItem","unshift","index","splice","storeOptions","scale","b","v","filter","allowType","updateOpacity","updateFontsize","updateBottomUp","from","EV","TIME_UPDATE","fire","PAUSE","ENDED","PLAY","SEEKED","onSeeked","LOADING_SHOW","LOADING_HIDE","off","removeNode","dispose","DanmakuSendBox","currentType","typeCBs","scroll","update","ev","getEventPath","popover","tooltip","inputEl","colorInputEl","send","components","I18n","addDisposableListener","createSvg","settingElement","Tooltip","Popover","sendEl","setPos","colorItem","panelElement","panelEl","rowElement","Checkbox","html","checked","change","onTypeChange","updateColor","colorEl","target","dataset","c","background","altKey","ctrlKey","metaKey","shiftKey","keyCode","which","control","require","release","resetPos","setBottom","DanmakuSetting","clamp","addClass","row","Switch","resetBtn","resetOptions","updateSettings","scrollCB","topCB","bottomCB","colorCB","opacitySlider","Slider","stops","areaSlider","step","updateArea","speedSlider","updateSpeed","fontsizeSlider","unlimitedCB","updateUnlimited","bottomUpCB","Plugin","registerControlItem","mounted","autoInsert","controls","findIndex"],"sourceRoot":""}